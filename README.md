# SARIMAX-Streamflow-Forecasting

SARIMAX streamflow forecasting for Shavers Fork, WV under RCP 4.5 and 8.5 using gridMET and MACA climate projections.

## Overview

This project uses a SARIMAX (Seasonal Autoregressive Integrated Moving Average with Exogenous Variables) model to forecast daily streamflow on Shavers Fork at Bowden, WV (USGS gauge 03068800) through 2099. The model is trained on 26 years of observed streamflow and gridded climate data (1998-2023), then driven by downscaled MACA projections (GFDL-ESM2M) under RCP scenarios 4.5 and 8.5.

Best model: **SARIMAX(6,1,1)(0,1,0)[365]** — Validation RMSE: 430.74 cfs

### Study Site
- **Watershed:** Shavers Fork HUC-10 (556 km²), Monongahela National Forest, WV
- **Stream Gauge:** USGS 03068800 — Shavers Fork at Bowden
- **Elevation:** ~490–1,350 m

### Data Sources

| Dataset | Period | Resolution | Source |
|---------|--------|-----------|--------|
| USGS NWIS Streamflow | 1998–2023 | Daily | [USGS Water Data](https://waterdata.usgs.gov/nwis) |
| gridMET Climate | 1998–2023 | Daily, ~4 km | [climatologylab.org/gridmet](https://www.climatologylab.org/gridmet.html) |
| MACA Projections (GFDL-ESM2M) | 2024–2099 | Daily, ~4 km | [climatologylab.org/maca](https://www.climatologylab.org/maca.html) |

### Exogenous Climate Variables
| Variable | gridMET | MACA | Zonal Stat |
|----------|---------|------|------------|
| Precipitation | pr | pr | Max |
| Solar Radiation | srad | rsds | Max |
| Min Temperature | tmmn | tasmin | Max |
| Max Temperature | tmmx | tasmax | Max |
| Vapor Pressure Deficit | vpd | vpd | Min |

## Repository Structure

```
├── R/
│   ├── data_extraction.R           # USGS + gridMET + MACA data retrieval & zonal stats
│   ├── exploratory_analysis.R      # STL decomposition, deseasonalization, PCA, ACF/PACF, stationarity
│   ├── data_preparation.R          # Cleaning, differencing, Granger causality, standardization
│   ├── sarimax_forecast.R          # Grid search, model fitting, RCP projections
│   └── results_visualization.R     # Actual vs modeled & projection plots
├── data/
│   ├── raw/                        # Generated by Script 01 (not tracked)
│   ├── processed/                  # Generated by Script 02 (not tracked)
│   └── README.md                   # Data documentation
├── docs/
│   ├── final_report.qmd            # Quarto source
│   └── final_report.html           # Rendered report
├── shp/                            # HUC-10 watershed shapefile
├── .gitignore
├── LICENSE
└── README.md
```

## Requirements

```r
# Data retrieval
install.packages(c("dataRetrieval", "devtools"))
devtools::install_github("mikejohnson51/climateR")

# Spatial
install.packages(c("sf", "sp", "terra", "raster"))

# Time series & statistics
install.packages(c("forecast", "tseries", "lmtest", "vars"))

# Data manipulation & visualization
install.packages(c("dplyr", "tidyr", "lubridate", "ggplot2"))
```

## Usage

Run scripts sequentially from the project root:

```bash
Rscript R/data_extraction.R           # Requires internet; several hours for MACA
Rscript R/exploratory_analysis.R      # STL, deseasonalization, PCA, ACF/PACF
Rscript R/data_preparation.R          # Stationarity, differencing, standardization
Rscript R/sarimax_forecast.R          # Grid search & RCP forecasting
Rscript R/results_visualization.R     # Generate plots
```

Script 01 requires the HUC-10 shapefile in `shp/`.

## Author

**Sean Keane**
West Virginia University — M.S. Energy Environments | GIS & Spatial Analysis Certificate
